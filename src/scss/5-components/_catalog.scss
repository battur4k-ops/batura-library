/* ============================================================
   3-OBJECTS / _CATALOG.SCSS
   Batura Library | Universal Indexing [Final Precision Sync]
   ============================================================ */

.b-catalog-section {
  display: flex;
  flex-direction: column;
  gap: var(--space-md);
  
  /* Proxy Variables для управления состоянием */
  --_stroke-op: var(--s-stroke-op-idle); 
  --_text-op: var(--s-text-op-idle);
  --_exit-delay: var(--stagger-step);

  /* [STATE: FOCUSED] - Секция в центре экрана (Scroll Physics) */
  &.is-focused {
    --_exit-delay: 0s;
    --_stroke-op: var(--s-stroke-op-hover); 
    --_text-op: var(--s-text-op-hover);     
  }

  /* [STATE: HOVER] - Для десктопа */
  &:hover {
    --_exit-delay: 0s;
    --_stroke-op: var(--s-stroke-op-active); 
    --_text-op: var(--s-text-op-hover);      
  }

  /* ============================================================
     MOBILE LOGIC: AUTO-ACTIVE ON SCROLL
     ============================================================ */
  @media (max-width: 768px) {
    &.is-focused {
      --_stroke-op: var(--s-stroke-op-active); // Линия вспыхивает на 0.98
      --_text-op: 1;                            // Текст на максимум
    }
  }
}

.b-catalog-header {
  display: flex;
  align-items: baseline;
  gap: var(--space-sm);
  padding-bottom: var(--space-xs);
  
  /* [PRECISION LINE PRINCIPLE] */
  /* Убираем border и заменяем на shadow для честных 0.5px без размытия */
  border-bottom: none;
  box-shadow: 0 var(--s-stroke-width) 0 0 rgba(var(--p-white-rgb), var(--_stroke-op));
  
  /* Стабилизация рендеринга в пиксельной сетке */
  transform: translateZ(0);
  backface-visibility: hidden;
  
  /* Переход строго по системе */
  transition: box-shadow var(--d-fast) var(--e-out) var(--_exit-delay);

  .letter {
    font-family: var(--font-main);
    font-size: var(--fs-h2);
    font-weight: 200;
    line-height: 1;
    color: rgba(var(--p-white-rgb), var(--_text-op));
    transition: color var(--d-fast) var(--e-out) var(--_exit-delay);
    margin-left: var(--text-offset-heading); // Оптическая компенсация
  }

  .index {
    @extend .text-data; 
    /* Индекс следует за яркостью секции через коэффициент 0.7 */
    color: rgba(var(--p-white-rgb), calc(var(--_text-op) * 0.7));
    transition: color var(--d-fast) var(--e-out) var(--_exit-delay);
  }
}

.l-grid-expressions {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(min(100%, 320px), 1fr));
  gap: var(--space-md);
  width: 100%;
  align-items: stretch; 
}