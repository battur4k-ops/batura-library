/* ============================================================
   5-COMPONENTS / _NAVBAR.SCSS
   Batura Library | System Synced v12.8 [Blur Sync & Smooth Morph]
   ============================================================ */

.b-navbar {
    /* 1. LOCAL TOKENS & GEOMETRY */
    --nav-radius: var(--radius-master);
    --nav-h: var(--nav-h-start);
    --nav-content-h: calc(var(--nav-h) * var(--nav-content-scale));
    --nav-pad: calc((var(--nav-h) - var(--nav-content-h)) / 2);
    --nav-inner-radius: calc(var(--nav-radius) - var(--nav-pad));

    /* 2. MATERIAL (Синхронизация со слотами) */
    --nav-bg-op: var(--s-glass-op-base);
    --nav-stroke-op: var(--s-stroke-op-idle);
    
    /* 
       [FIX] Навбар объявляет свою переменную блюра.
       Теперь миксин её "услышит" и применит.
    */
    --nav-blur: var(--s-glass-blur);

    @include glass-surface("nav", var(--nav-radius));
    
    /* 3. LAYOUT */
    position: fixed;
    top: var(--nav-top);
    z-index: var(--z-nav);
    inset-inline: 0;
    margin-inline: auto;
    height: var(--nav-h);
    width: calc(var(--nav-w-factor) * min(var(--stable-content-width), var(--stable-max-content)));
    padding-inline: var(--nav-pad); 
    display: flex;
    align-items: center;
    
    /* [STABILITY LOCK] */
    transform: translate3d(0, 0, 0.1px); 
    backface-visibility: hidden;
    perspective: 1000px;
    
    contain: layout;
    will-change: height, width, border-radius, background-color;

    /* 4. MOTION ENGINE */
    transition: 
        height var(--d-morph) var(--e-out),
        width var(--d-morph) var(--e-out),
        border-radius var(--d-morph) var(--e-out),
        padding var(--d-morph) var(--e-out),
        background-color var(--d-fast) var(--e-out),
        box-shadow var(--d-fast) var(--e-out),
        backdrop-filter var(--d-morph) var(--e-out);

    &::before { display: none; } 

    /* 5. SCROLL STATE */
    body.is-scrolled & {
        --nav-h: var(--nav-h-morph);
        --nav-w-factor: var(--nav-w-morph);
        --nav-bg-op: var(--s-glass-op-hover); 
        --nav-stroke-op: var(--s-stroke-op-hover);
        
        /* При скролле уплотняем блюр для премиального эффекта */
        --nav-blur: calc(var(--s-glass-blur) * 1.5); 

        /* Передаем состояние вложенным кнопкам */
        .ui-button {
            --btn-bg-op: var(--s-glass-op-hover);
            --btn-stroke-op: var(--s-stroke-op-hover);
        }
    }

    &__brand {
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
        height: var(--nav-content-h);
        width: var(--nav-content-h);
        
        /* Стабилизация вложенного логотипа */
        transform: translateZ(0);
    }
}